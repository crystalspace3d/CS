<?xml version="1.0" encoding="utf-8" ?>
<shader compiler="shaderweaver" name="water">
	<shadervar name="water perturb scale" type="vector4">0.1,0.1,0,0</shadervar>
	<shadervar name="water perturb fade" type="float">1</shadervar>
  
	<technique priority="200">
		<pass>		
			<combiner name="glsl" plugin="crystalspace.graphics3d.shader.combiner.glsl" />
	 
			<snippet id="wave" file="/shader/snippets/wave.xml" />
			<snippet id="reflection" file="/shader-snippets/reflect/reflect-plane-screen.xml" />
			<snippet id="refraction" file="/shader-snippets/reflect/reflect-plane-screen.xml" />
			
			<connection from="wave" to="reflection" />
			<connection from="wave" to="refraction" />
			
			<parameter id="texRefract" type="shadervar" weavertype="tex2d">tex plane refract</parameter>
			<connection from="texRefract" to="refraction" />
			
			<parameter id="texRefractXform" type="shadervar" weavertype="translateScale2">refraction coord xform</parameter>
			<connection from="texRefractXform" to="refraction" />
			
		</pass>
	</technique>
	
	<technique priority="100">
		<pass>
			<combiner name="cg" plugin="crystalspace.graphics3d.shader.combiner.glcg" />
			
			<snippet id="wave" file="/shader/snippets/wave.xml" />
			<snippet id="reflection" file="/shader-snippets/reflect/reflect-plane-screen.xml" />
			<snippet id="refraction" file="/shader-snippets/reflect/reflect-plane-screen.xml" />
			
			<connection from="wave" to="reflection" />
			<connection from="wave" to="refraction" />
			
			<parameter id="texRefract" type="shadervar" weavertype="tex2d">tex plane refract</parameter>
			<connection from="texRefract" to="refraction" />
			
			<parameter id="texRefractXform" type="shadervar" weavertype="translateScale2">refraction coord xform</parameter>
			<connection from="texRefractXform" to="refraction" />
			
		</pass>
	</technique>
</shader> 
